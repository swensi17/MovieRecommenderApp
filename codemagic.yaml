workflows:
  ios-workflow:
    name: iOS Workflow
    max_build_duration: 120
    instance_type: mac_mini_m1
    environment:
      xcode: latest
      cocoapods: default
    scripts:
      - name: Debug Info
        script: |
          echo "Current directory:"
          pwd
          echo "\nDirectory contents:"
          ls -la
          echo "\nProject structure:"
          find . -type f
          echo "\nXcode version:"
          xcodebuild -version
          echo "\nXcode project info:"
          xcodebuild -list -project MovieApp.xcodeproj || echo "Failed to list project info"
          
      - name: Build for simulator
        script: |
          xcodebuild clean build \
            -project MovieApp.xcodeproj \
            -scheme MovieApp \
            -configuration Debug \
            -sdk iphonesimulator \
            -destination 'platform=iOS Simulator,name=iPhone 14,OS=latest' \
            CODE_SIGN_IDENTITY="" \
            CODE_SIGNING_REQUIRED=NO \
            CODE_SIGNING_ALLOWED=NO \
            SWIFT_VERSION=5.0 \
            DEVELOPMENT_TEAM="" \
            PRODUCT_BUNDLE_IDENTIFIER="com.example.MovieApp" \
            ASSETCATALOG_COMPILER_APPICON_NAME="" \
            -verbose
    artifacts:
      - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.app
